<?xml version="1.0" encoding="UTF-8"?>
<ref:mapRef xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:map="http://www.indy.com/v2/map" xmlns:ref="http://www.indy.com/v2/ref" id="__uAidzXDEe2goMzdputf-Q">
  <dataModel>_CgoeMJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=Update%20dim_customer.cus_vip%20step1?</dataModel>
  <containerRef xsi:type="ref:RDatastore" id="__uBwkTXDEe2goMzdputf-Q" countShownFields="5" hierarchical="false">
    <dataModel>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="__uBwkjXDEe2goMzdputf-Q" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7mbPsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>__uBwkDXDEe2goMzdputf-Q</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uBwkzXDEe2goMzdputf-Q" precision="6" size="29" type="timestamp" position="15">
      <dataModel>_7mb2w5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_pmt_date?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uBwlDXDEe2goMzdputf-Q" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7mb2wJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <usage>__uGpETXDEe2goMzdputf-Q</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uBwlTXDEe2goMzdputf-Q" precision="0" size="8" type="varchar" position="9">
      <dataModel>_7mb2wZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pmt_code?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uBwljXDEe2goMzdputf-Q" precision="6" size="29" type="timestamp" mandatory="true" position="12">
      <dataModel>_7mb2wpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_date?</dataModel>
    </fieldRef>
    <constraintRef id="__uCXoDXDEe2goMzdputf-Q" type="pk">
      <dataModel>_7mb2xJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing?</dataModel>
    </constraintRef>
    <constraintRef id="__uCXoTXDEe2goMzdputf-Q" type="fk">
      <dataModel>_7mb2xZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_customer?</dataModel>
    </constraintRef>
    <constraintRef id="__uCXojXDEe2goMzdputf-Q" type="fk">
      <dataModel>_7mb2xpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_payment?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="__uC-sDXDEe2goMzdputf-Q" countShownFields="8" hierarchical="false">
    <dataModel>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="__uC-sTXDEe2goMzdputf-Q" precision="4" size="19" type="numeric" mandatory="true" position="9">
      <dataModel>_7-P50pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_qty?</dataModel>
      <usage>__uH3MTXDEe2goMzdputf-Q</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uC-sjXDEe2goMzdputf-Q" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7-P50JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uC-szXDEe2goMzdputf-Q" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7-P50ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>__uBwkDXDEe2goMzdputf-Q</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uC-tDXDEe2goMzdputf-Q" precision="4" size="19" type="numeric" position="15">
      <dataModel>_7-P51JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_amount?</dataModel>
      <usage>__uH3MTXDEe2goMzdputf-Q</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uC-tTXDEe2goMzdputf-Q" precision="4" size="19" type="numeric" mandatory="true" position="18">
      <dataModel>_7-Qg4JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_amount?</dataModel>
      <usage>__uH3MTXDEe2goMzdputf-Q</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uC-tjXDEe2goMzdputf-Q" precision="0" size="10" type="integer" position="24">
      <dataModel>_7-Qg4pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bdr_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uC-tzXDEe2goMzdputf-Q" precision="4" size="19" type="numeric" position="12">
      <dataModel>_7-P505fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_rate?</dataModel>
      <usage>__uH3MTXDEe2goMzdputf-Q</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uC-uDXDEe2goMzdputf-Q" precision="0" size="3" type="varchar" mandatory="true" position="21">
      <dataModel>_7-Qg4ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_type?</dataModel>
    </fieldRef>
    <constraintRef id="__uDlwDXDEe2goMzdputf-Q" type="fk">
      <dataModel>_7-Qg45fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_bedroom?</dataModel>
    </constraintRef>
    <constraintRef id="__uDlwTXDEe2goMzdputf-Q" type="fk">
      <dataModel>_7-Qg5JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_billing?</dataModel>
    </constraintRef>
    <constraintRef id="__uDlwjXDEe2goMzdputf-Q" type="pk">
      <dataModel>_7-Qg5ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing_lines?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="__uEM0DXDEe2goMzdputf-Q" countShownFields="7" hierarchical="false">
    <dataModel>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="__uEM0TXDEe2goMzdputf-Q" precision="0" size="32" type="varchar" position="6">
      <dataModel>__a3KoZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_title?</dataModel>
      <expressionRef id="__uGpEjXDEe2goMzdputf-Q">
        <dataModel>_AETJMJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uEM0jXDEe2goMzdputf-Q" precision="0" size="100" type="varchar" mandatory="true" position="9">
      <dataModel>__a3KopfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_name?</dataModel>
      <expressionRef id="__uGpEzXDEe2goMzdputf-Q">
        <dataModel>_AETJMZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uEM0zXDEe2goMzdputf-Q" precision="0" size="10" type="numeric" position="15">
      <dataModel>__a3KpJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=geo_key_id?</dataModel>
      <expressionRef id="__uIeQDXDEe2goMzdputf-Q">
        <dataModel>_AETJNJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uEM1DXDEe2goMzdputf-Q" precision="0" size="100" type="varchar" position="12">
      <dataModel>__a3Ko5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_company?</dataModel>
      <expressionRef id="__uIeQTXDEe2goMzdputf-Q">
        <dataModel>_AETJNZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uEM1TXDEe2goMzdputf-Q" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>__a3KoJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <expressionRef id="__uGpETXDEe2goMzdputf-Q" internalExpression="${t_billing.cus_id}$">
        <dataModel>_AESiIZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>__uBwlDXDEe2goMzdputf-Q</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uEM1jXDEe2goMzdputf-Q" precision="0" size="1" type="numeric" position="18">
      <dataModel>__a3KpZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_vip?</dataModel>
      <expressionRef id="__uH3MTXDEe2goMzdputf-Q" internalExpression="CASE WHEN SUM( ${t_billing_lines.lin_qty}$&#xA;              *(( ${t_billing_lines.lin_amount}$&#xA;                 -${t_billing_lines.lin_discount_amount}$ ) &#xA;&#x9;&#x9;&#x9;   -( ${t_billing_lines.lin_amount}$&#xA;&#x9;&#x9;&#x9;     *${t_billing_lines.lin_discount_rate}$ /100)))>64000 THEN 1&#xA;     ELSE 0&#xA;END">
        <dataModel>_AETJM5fcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>__uC-sTXDEe2goMzdputf-Q</sourceRef>
        <sourceRef>__uC-tTXDEe2goMzdputf-Q</sourceRef>
        <sourceRef>__uC-tDXDEe2goMzdputf-Q</sourceRef>
        <sourceRef>__uC-tzXDEe2goMzdputf-Q</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="__uEM1zXDEe2goMzdputf-Q" precision="6" size="29" type="timestamp" position="21">
      <dataModel>__a3xsJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=update_date?</dataModel>
      <expressionRef id="__uGpFDXDEe2goMzdputf-Q" internalExpression="d::currentTimestamp()">
        <dataModel>_AETJMpfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>__uH3MDXDEe2goMzdputf-Q</sourceRef>
      </expressionRef>
    </fieldRef>
    <constraintRef id="__uEz4DXDEe2goMzdputf-Q" type="fk">
      <dataModel>__a3xsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_dim_customer_geo?</dataModel>
    </constraintRef>
    <constraintRef id="__uFa8DXDEe2goMzdputf-Q" type="pk">
      <dataModel>__a3xspfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_dim_customer?</dataModel>
    </constraintRef>
    <constraintRef id="__uFa8TXDEe2goMzdputf-Q" type="ck">
      <dataModel>__a3xs5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_001?</dataModel>
    </constraintRef>
    <constraintRef id="__uFa8jXDEe2goMzdputf-Q" type="ck">
      <dataModel>__a3xtJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_002?</dataModel>
    </constraintRef>
  </containerRef>
  <clauseRef id="__uBwkDXDEe2goMzdputf-Q" internalExpression="${t_billing.bil_id}$ = ${t_billing_lines.bil_id}$">
    <dataModel>_9YwwAJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <sourceRef>__uBwkjXDEe2goMzdputf-Q</sourceRef>
    <sourceRef>__uC-szXDEe2goMzdputf-Q</sourceRef>
  </clauseRef>
  <targetSetRef id="__uQaETXDEe2goMzdputf-Q" sourceSet="__uQaEDXDEe2goMzdputf-Q">
    <container>__uEM0DXDEe2goMzdputf-Q</container>
  </targetSetRef>
  <sourceSetRef id="__uQaEDXDEe2goMzdputf-Q" targetSet="__uQaETXDEe2goMzdputf-Q">
    <dataSet xsi:type="map:DataSet">#_i8GYsKFXEey36u14s9YJuA</dataSet>
  </sourceSetRef>
  <templateRef id="__uIeRjXDEe2goMzdputf-Q" description="Load : t_billing, t_billing_lines" nodeCode="com.stambia.flow.step" templateCriteria="type=L-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcProduct=POSTGRESSQL;srcPath=server:hotel/schema:hotel.hotel_management/datastore:t_billing;srcWorkspaceCapability=true;srcMapCapability=true;srcFilterCapability=true;srcJoinCapability=true">
    <dataModel>_i8KDEKFXEey36u14s9YJuA?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=L1_dim_customer?</dataModel>
    <problem id="__ud1cDXDEe2goMzdputf-Q" code="WARNING_TEMPLATE_USING_UNPROVIDED_PROCESS" message=""/>
    <load>__uIeQzXDEe2goMzdputf-Q</load>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <templateRef id="__uKTcDXDEe2goMzdputf-Q" description="Integration : dim_customer" nodeCode="com.stambia.flow.step" templateCriteria="type=I-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcProductList=POSTGRESSQL">
    <dataModel>_i8L4QKFXEey36u14s9YJuA?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=I_dim_customer?</dataModel>
    <problem id="__ud1cTXDEe2goMzdputf-Q" code="WARNING_TEMPLATE_USING_UNPROVIDED_PROCESS" message=""/>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <loadSet id="__uIeRTXDEe2goMzdputf-Q">
    <container>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <loadSet id="__uIeQzXDEe2goMzdputf-Q">
    <container>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
    <container>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <udfRef id="__uH3MDXDEe2goMzdputf-Q">
    <dataModel>_epkM4JfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <usage>__uGpFDXDEe2goMzdputf-Q</usage>
  </udfRef>
</ref:mapRef>