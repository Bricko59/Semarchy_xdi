<?xml version="1.0" encoding="UTF-8"?>
<ref:mapRef xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:map="http://www.indy.com/v2/map" xmlns:ref="http://www.indy.com/v2/ref" id="_h429kKFYEeyDMuS-IfoEog">
  <dataModel>_CgoeMJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=Update%20dim_customer.cus_vip%20step1?</dataModel>
  <containerRef xsi:type="ref:RDatastore" id="_h5B8sKFYEeyDMuS-IfoEog" countShownFields="5" hierarchical="false">
    <dataModel>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_h5X68KFYEeyDMuS-IfoEog" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7mbPsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>_h5BVoKFYEeyDMuS-IfoEog</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5ZwIKFYEeyDMuS-IfoEog" precision="6" size="29" type="timestamp" position="15">
      <dataModel>_7mb2w5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_pmt_date?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5ZwIaFYEeyDMuS-IfoEog" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7mb2wJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <usage>_h5mkcaFYEeyDMuS-IfoEog</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5ZwIqFYEeyDMuS-IfoEog" precision="0" size="8" type="varchar" position="9">
      <dataModel>_7mb2wZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pmt_code?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5ZwI6FYEeyDMuS-IfoEog" precision="6" size="29" type="timestamp" mandatory="true" position="12">
      <dataModel>_7mb2wpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_date?</dataModel>
    </fieldRef>
    <constraintRef id="_h5aXMKFYEeyDMuS-IfoEog" type="pk">
      <dataModel>_7mb2xJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing?</dataModel>
    </constraintRef>
    <constraintRef id="_h5aXMaFYEeyDMuS-IfoEog" type="fk">
      <dataModel>_7mb2xZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_customer?</dataModel>
    </constraintRef>
    <constraintRef id="_h5aXMqFYEeyDMuS-IfoEog" type="fk">
      <dataModel>_7mb2xpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_payment?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="_h5a-QKFYEeyDMuS-IfoEog" countShownFields="8" hierarchical="false">
    <dataModel>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_h5a-QaFYEeyDMuS-IfoEog" precision="4" size="19" type="numeric" mandatory="true" position="9">
      <dataModel>_7-P50pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_qty?</dataModel>
      <usage>_h5mkdqFYEeyDMuS-IfoEog</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5a-QqFYEeyDMuS-IfoEog" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7-P50JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5a-Q6FYEeyDMuS-IfoEog" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7-P50ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>_h5BVoKFYEeyDMuS-IfoEog</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5blUKFYEeyDMuS-IfoEog" precision="4" size="19" type="numeric" position="15">
      <dataModel>_7-P51JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_amount?</dataModel>
      <usage>_h5mkdqFYEeyDMuS-IfoEog</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5blUaFYEeyDMuS-IfoEog" precision="4" size="19" type="numeric" mandatory="true" position="18">
      <dataModel>_7-Qg4JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_amount?</dataModel>
      <usage>_h5mkdqFYEeyDMuS-IfoEog</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5blUqFYEeyDMuS-IfoEog" precision="0" size="10" type="integer" position="24">
      <dataModel>_7-Qg4pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bdr_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5blU6FYEeyDMuS-IfoEog" precision="4" size="19" type="numeric" position="12">
      <dataModel>_7-P505fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_rate?</dataModel>
      <usage>_h5mkdqFYEeyDMuS-IfoEog</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5blVKFYEeyDMuS-IfoEog" precision="0" size="3" type="varchar" mandatory="true" position="21">
      <dataModel>_7-Qg4ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_type?</dataModel>
    </fieldRef>
    <constraintRef id="_h5blVaFYEeyDMuS-IfoEog" type="fk">
      <dataModel>_7-Qg45fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_bedroom?</dataModel>
    </constraintRef>
    <constraintRef id="_h5blVqFYEeyDMuS-IfoEog" type="fk">
      <dataModel>_7-Qg5JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_billing?</dataModel>
    </constraintRef>
    <constraintRef id="_h5blV6FYEeyDMuS-IfoEog" type="pk">
      <dataModel>_7-Qg5ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing_lines?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="_h5cMYKFYEeyDMuS-IfoEog" countShownFields="7" hierarchical="false">
    <dataModel>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_h5jhIKFYEeyDMuS-IfoEog" precision="0" size="32" type="varchar" position="6">
      <dataModel>__a3KoZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_title?</dataModel>
      <expressionRef id="_h5mkcqFYEeyDMuS-IfoEog">
        <dataModel>_AETJMJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5kvQKFYEeyDMuS-IfoEog" precision="0" size="100" type="varchar" mandatory="true" position="9">
      <dataModel>__a3KopfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_name?</dataModel>
      <expressionRef id="_h5mkc6FYEeyDMuS-IfoEog">
        <dataModel>_AETJMZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5kvQaFYEeyDMuS-IfoEog" precision="0" size="10" type="numeric" position="15">
      <dataModel>__a3KpJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=geo_key_id?</dataModel>
      <expressionRef id="_h5mkd6FYEeyDMuS-IfoEog">
        <dataModel>_AETJNJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5kvQqFYEeyDMuS-IfoEog" precision="0" size="100" type="varchar" position="12">
      <dataModel>__a3Ko5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_company?</dataModel>
      <expressionRef id="_h5mkeKFYEeyDMuS-IfoEog">
        <dataModel>_AETJNZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5kvQ6FYEeyDMuS-IfoEog" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>__a3KoJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <expressionRef id="_h5mkcaFYEeyDMuS-IfoEog" internalExpression="${t_billing.cus_id}$">
        <dataModel>_AESiIZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_h5ZwIaFYEeyDMuS-IfoEog</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5lWUKFYEeyDMuS-IfoEog" precision="0" size="1" type="numeric" position="18">
      <dataModel>__a3KpZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_vip?</dataModel>
      <expressionRef id="_h5mkdqFYEeyDMuS-IfoEog" internalExpression="CASE WHEN SUM( ${t_billing_lines.lin_qty}$&#xA;              *(( ${t_billing_lines.lin_amount}$&#xA;                 -${t_billing_lines.lin_discount_amount}$ ) &#xA;&#x9;&#x9;&#x9;   -( ${t_billing_lines.lin_amount}$&#xA;&#x9;&#x9;&#x9;     *${t_billing_lines.lin_discount_rate}$ /100)))>64000 THEN 1&#xA;     ELSE 0&#xA;END">
        <dataModel>_AETJM5fcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_h5a-QaFYEeyDMuS-IfoEog</sourceRef>
        <sourceRef>_h5blUaFYEeyDMuS-IfoEog</sourceRef>
        <sourceRef>_h5blUKFYEeyDMuS-IfoEog</sourceRef>
        <sourceRef>_h5blU6FYEeyDMuS-IfoEog</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_h5lWUaFYEeyDMuS-IfoEog" precision="6" size="29" type="timestamp" position="21">
      <dataModel>__a3xsJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=update_date?</dataModel>
      <expressionRef id="_h5mkdKFYEeyDMuS-IfoEog" internalExpression="d::currentTimestamp()">
        <dataModel>_AETJMpfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_h5mkdaFYEeyDMuS-IfoEog</sourceRef>
      </expressionRef>
    </fieldRef>
    <constraintRef id="_h5lWUqFYEeyDMuS-IfoEog" type="fk">
      <dataModel>__a3xsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_dim_customer_geo?</dataModel>
    </constraintRef>
    <constraintRef id="_h5lWU6FYEeyDMuS-IfoEog" type="pk">
      <dataModel>__a3xspfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_dim_customer?</dataModel>
    </constraintRef>
    <constraintRef id="_h5lWVKFYEeyDMuS-IfoEog" type="ck">
      <dataModel>__a3xs5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_001?</dataModel>
    </constraintRef>
    <constraintRef id="_h5lWVaFYEeyDMuS-IfoEog" type="ck">
      <dataModel>__a3xtJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_002?</dataModel>
    </constraintRef>
  </containerRef>
  <clauseRef id="_h5BVoKFYEeyDMuS-IfoEog" internalExpression="${t_billing.bil_id}$ = ${t_billing_lines.bil_id}$">
    <dataModel>_9YwwAJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <sourceRef>_h5X68KFYEeyDMuS-IfoEog</sourceRef>
    <sourceRef>_h5a-Q6FYEeyDMuS-IfoEog</sourceRef>
  </clauseRef>
  <targetSetRef id="_h5oZoaFYEeyDMuS-IfoEog" sourceSet="_h5oZoKFYEeyDMuS-IfoEog">
    <container>_h5cMYKFYEeyDMuS-IfoEog</container>
  </targetSetRef>
  <sourceSetRef id="_h5oZoKFYEeyDMuS-IfoEog" targetSet="_h5oZoaFYEeyDMuS-IfoEog">
    <dataSet xsi:type="map:DataSet">#_i8GYsKFXEey36u14s9YJuA</dataSet>
  </sourceSetRef>
  <templateRef id="_h5nLhKFYEeyDMuS-IfoEog" description="Load : t_billing, t_billing_lines" nodeCode="com.stambia.flow.step" templateCriteria="type=L-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcProduct=POSTGRESSQL;srcPath=server:hotel/schema:hotel.hotel_management/datastore:t_billing;srcWorkspaceCapability=true;srcMapCapability=true;srcFilterCapability=true;srcJoinCapability=true">
    <dataModel>_i8KDEKFXEey36u14s9YJuA?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=L1_dim_customer?</dataModel>
    <problem id="_h56GcKFYEeyDMuS-IfoEog" code="WARNING_TEMPLATE_USING_UNPROVIDED_PROCESS" message=""/>
    <load>_h5nLgaFYEeyDMuS-IfoEog</load>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <templateRef id="_h5nylaFYEeyDMuS-IfoEog" description="Integration : dim_customer" nodeCode="com.stambia.flow.step" templateCriteria="type=I-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcProductList=POSTGRESSQL">
    <dataModel>_i8L4QKFXEey36u14s9YJuA?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=I_dim_customer?</dataModel>
    <problem id="_h56GcaFYEeyDMuS-IfoEog" code="WARNING_TEMPLATE_USING_UNPROVIDED_PROCESS" message=""/>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <loadSet id="_h5nLgaFYEeyDMuS-IfoEog">
    <container>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
    <container>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <loadSet id="_h5nLg6FYEeyDMuS-IfoEog">
    <container>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <udfRef id="_h5mkdaFYEeyDMuS-IfoEog">
    <dataModel>_epkM4JfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <usage>_h5mkdKFYEeyDMuS-IfoEog</usage>
  </udfRef>
</ref:mapRef>