<?xml version="1.0" encoding="UTF-8"?>
<ref:mapRef xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:map="http://www.indy.com/v2/map" xmlns:ref="http://www.indy.com/v2/ref" id="_oUiglZfhEeyNk-8PTn1xFw">
  <dataModel>_CgoeMJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=Update%20dim_customer.cus_vip%20step1?</dataModel>
  <containerRef xsi:type="ref:RDatastore" id="_oUrDcZfhEeyNk-8PTn1xFw" countShownFields="5" hierarchical="false">
    <dataModel>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_oU6UAJfhEeyNk-8PTn1xFw" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7mbPsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>_oUrDcJfhEeyNk-8PTn1xFw</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU6UAZfhEeyNk-8PTn1xFw" precision="6" size="29" type="timestamp" position="15">
      <dataModel>_7mb2w5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_pmt_date?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU8wQJfhEeyNk-8PTn1xFw" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7mb2wJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <usage>_oVEFAZfhEeyNk-8PTn1xFw</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU8wQZfhEeyNk-8PTn1xFw" precision="0" size="8" type="varchar" position="9">
      <dataModel>_7mb2wZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pmt_code?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU8wQpfhEeyNk-8PTn1xFw" precision="6" size="29" type="timestamp" mandatory="true" position="12">
      <dataModel>_7mb2wpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_date?</dataModel>
    </fieldRef>
    <constraintRef id="_oU9XUJfhEeyNk-8PTn1xFw" type="pk">
      <dataModel>_7mb2xJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing?</dataModel>
    </constraintRef>
    <constraintRef id="_oU9XUZfhEeyNk-8PTn1xFw" type="fk">
      <dataModel>_7mb2xZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_customer?</dataModel>
    </constraintRef>
    <constraintRef id="_oU9XUpfhEeyNk-8PTn1xFw" type="fk">
      <dataModel>_7mb2xpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_payment?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="_oU9XU5fhEeyNk-8PTn1xFw" countShownFields="8" hierarchical="false">
    <dataModel>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_oU9XVJfhEeyNk-8PTn1xFw" precision="4" size="19" type="numeric" mandatory="true" position="9">
      <dataModel>_7-P50pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_qty?</dataModel>
      <usage>_oVEFBpfhEeyNk-8PTn1xFw</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU9XVZfhEeyNk-8PTn1xFw" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7-P50JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU9-YJfhEeyNk-8PTn1xFw" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7-P50ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>_oUrDcJfhEeyNk-8PTn1xFw</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU9-YZfhEeyNk-8PTn1xFw" precision="4" size="19" type="numeric" position="15">
      <dataModel>_7-P51JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_amount?</dataModel>
      <usage>_oVEFBpfhEeyNk-8PTn1xFw</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU9-YpfhEeyNk-8PTn1xFw" precision="4" size="19" type="numeric" mandatory="true" position="18">
      <dataModel>_7-Qg4JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_amount?</dataModel>
      <usage>_oVEFBpfhEeyNk-8PTn1xFw</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU9-Y5fhEeyNk-8PTn1xFw" precision="0" size="10" type="integer" position="24">
      <dataModel>_7-Qg4pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bdr_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU9-ZJfhEeyNk-8PTn1xFw" precision="4" size="19" type="numeric" position="12">
      <dataModel>_7-P505fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_rate?</dataModel>
      <usage>_oVEFBpfhEeyNk-8PTn1xFw</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oU9-ZZfhEeyNk-8PTn1xFw" precision="0" size="3" type="varchar" mandatory="true" position="21">
      <dataModel>_7-Qg4ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_type?</dataModel>
    </fieldRef>
    <constraintRef id="_oU9-ZpfhEeyNk-8PTn1xFw" type="fk">
      <dataModel>_7-Qg45fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_bedroom?</dataModel>
    </constraintRef>
    <constraintRef id="_oU9-Z5fhEeyNk-8PTn1xFw" type="fk">
      <dataModel>_7-Qg5JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_billing?</dataModel>
    </constraintRef>
    <constraintRef id="_oU9-aJfhEeyNk-8PTn1xFw" type="pk">
      <dataModel>_7-Qg5ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing_lines?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="_oU9-aZfhEeyNk-8PTn1xFw" countShownFields="7" hierarchical="false">
    <dataModel>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_oVC24JfhEeyNk-8PTn1xFw" precision="0" size="32" type="varchar" position="6">
      <dataModel>__a3KoZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_title?</dataModel>
      <expressionRef id="_oVEFApfhEeyNk-8PTn1xFw">
        <dataModel>_AETJMJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oVC24ZfhEeyNk-8PTn1xFw" precision="0" size="100" type="varchar" mandatory="true" position="9">
      <dataModel>__a3KopfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_name?</dataModel>
      <expressionRef id="_oVEFA5fhEeyNk-8PTn1xFw">
        <dataModel>_AETJMZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oVC24pfhEeyNk-8PTn1xFw" precision="0" size="10" type="numeric" position="15">
      <dataModel>__a3KpJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=geo_key_id?</dataModel>
      <expressionRef id="_oVEFB5fhEeyNk-8PTn1xFw">
        <dataModel>_AETJNJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oVC245fhEeyNk-8PTn1xFw" precision="0" size="100" type="varchar" position="12">
      <dataModel>__a3Ko5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_company?</dataModel>
      <expressionRef id="_oVEFCJfhEeyNk-8PTn1xFw">
        <dataModel>_AETJNZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oVC25JfhEeyNk-8PTn1xFw" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>__a3KoJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <expressionRef id="_oVEFAZfhEeyNk-8PTn1xFw" internalExpression="${t_billing.cus_id}$">
        <dataModel>_AESiIZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_oU8wQJfhEeyNk-8PTn1xFw</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oVC25ZfhEeyNk-8PTn1xFw" precision="0" size="1" status="VALID" type="numeric" position="18">
      <dataModel>__a3KpZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_vip?</dataModel>
      <expressionRef id="_oVEFBpfhEeyNk-8PTn1xFw" internalExpression="CASE WHEN SUM( ${t_billing_lines.lin_qty}$&#xA;              *(( ${t_billing_lines.lin_amount}$&#xA;                 -${t_billing_lines.lin_discount_amount}$ ) &#xA;&#x9;&#x9;&#x9;   -( ${t_billing_lines.lin_amount}$&#xA;&#x9;&#x9;&#x9;     *${t_billing_lines.lin_discount_rate}$ /100)))>64000 THEN 1&#xA;     ELSE 0&#xA;END">
        <dataModel>_AETJM5fcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_oU9XVJfhEeyNk-8PTn1xFw</sourceRef>
        <sourceRef>_oU9-YpfhEeyNk-8PTn1xFw</sourceRef>
        <sourceRef>_oU9-YZfhEeyNk-8PTn1xFw</sourceRef>
        <sourceRef>_oU9-ZJfhEeyNk-8PTn1xFw</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_oVC25pfhEeyNk-8PTn1xFw" precision="6" size="29" type="timestamp" position="21">
      <dataModel>__a3xsJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=update_date?</dataModel>
      <expressionRef id="_oVEFBJfhEeyNk-8PTn1xFw" internalExpression="d::currentTimestamp()">
        <dataModel>_AETJMpfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_oVEFBZfhEeyNk-8PTn1xFw</sourceRef>
      </expressionRef>
    </fieldRef>
    <constraintRef id="_oVDd8JfhEeyNk-8PTn1xFw" type="fk">
      <dataModel>__a3xsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_dim_customer_geo?</dataModel>
    </constraintRef>
    <constraintRef id="_oVDd8ZfhEeyNk-8PTn1xFw" type="pk">
      <dataModel>__a3xspfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_dim_customer?</dataModel>
    </constraintRef>
    <constraintRef id="_oVDd8pfhEeyNk-8PTn1xFw" type="ck">
      <dataModel>__a3xs5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_001?</dataModel>
    </constraintRef>
    <constraintRef id="_oVDd85fhEeyNk-8PTn1xFw" type="ck">
      <dataModel>__a3xtJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_002?</dataModel>
    </constraintRef>
  </containerRef>
  <clauseRef id="_oUrDcJfhEeyNk-8PTn1xFw" internalExpression="${t_billing.bil_id}$ = ${t_billing_lines.bil_id}$">
    <dataModel>_9YwwAJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <sourceRef>_oU6UAJfhEeyNk-8PTn1xFw</sourceRef>
    <sourceRef>_oU9-YJfhEeyNk-8PTn1xFw</sourceRef>
  </clauseRef>
  <targetSetRef id="_GRh4wZfiEeyNk-8PTn1xFw" sourceSet="_GRh4wJfiEeyNk-8PTn1xFw">
    <container>_oU9-aZfhEeyNk-8PTn1xFw</container>
  </targetSetRef>
  <sourceSetRef id="_GRh4wJfiEeyNk-8PTn1xFw" targetSet="_GRh4wZfiEeyNk-8PTn1xFw">
    <dataSet xsi:type="map:DataSet">#_7d3esJfdEeyNk-8PTn1xFw</dataSet>
  </sourceSetRef>
  <templateRef id="_oVEFDZfhEeyNk-8PTn1xFw" description="Load : t_billing, t_billing_lines" nodeCode="com.stambia.flow.step" templateCriteria="type=L-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgTech=RDBMS;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcProduct=POSTGRESSQL;srcPath=server:hotel/schema:hotel.hotel_management/datastore:t_billing;srcTech=RDBMS;srcWorkspaceCapability=true;srcMapCapability=true;srcFilterCapability=true;srcJoinCapability=true">
    <dataModel>_7d7JEJfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=L1_dim_customer?</dataModel>
    <load>_oVEFCpfhEeyNk-8PTn1xFw</load>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <templateRef id="_oVF6MJfhEeyNk-8PTn1xFw" description="Integration : dim_customer" nodeCode="com.stambia.flow.step" templateCriteria="type=I-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgTech=RDBMS;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcTechList=RDBMS;srcProductList=POSTGRESSQL">
    <dataModel>_7d9lUJfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=I_dim_customer?</dataModel>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <loadSet id="_oVEFCpfhEeyNk-8PTn1xFw">
    <container>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
    <container>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <loadSet id="_oVEFDJfhEeyNk-8PTn1xFw">
    <container>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <udfRef id="_oVEFBZfhEeyNk-8PTn1xFw">
    <dataModel>_epkM4JfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <usage>_oVEFBJfhEeyNk-8PTn1xFw</usage>
  </udfRef>
</ref:mapRef>