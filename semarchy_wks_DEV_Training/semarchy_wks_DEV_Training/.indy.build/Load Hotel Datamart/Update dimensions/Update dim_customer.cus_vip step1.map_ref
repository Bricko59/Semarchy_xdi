<?xml version="1.0" encoding="UTF-8"?>
<ref:mapRef xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:map="http://www.indy.com/v2/map" xmlns:ref="http://www.indy.com/v2/ref" id="_UDYFx5fnEeyJYM9CAJZuPA">
  <dataModel>_CgoeMJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=Update%20dim_customer.cus_vip%20step1?</dataModel>
  <containerRef xsi:type="ref:RDatastore" id="_UDYFyZfnEeyJYM9CAJZuPA" countShownFields="5" hierarchical="false">
    <dataModel>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_UDc-QJfnEeyJYM9CAJZuPA" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7mbPsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>_UDYFyJfnEeyJYM9CAJZuPA</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDeMYJfnEeyJYM9CAJZuPA" precision="6" size="29" type="timestamp" position="15">
      <dataModel>_7mb2w5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_pmt_date?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDeMYZfnEeyJYM9CAJZuPA" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7mb2wJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <usage>_UDgooZfnEeyJYM9CAJZuPA</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDeMYpfnEeyJYM9CAJZuPA" precision="0" size="8" type="varchar" position="9">
      <dataModel>_7mb2wZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pmt_code?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDeMY5fnEeyJYM9CAJZuPA" precision="6" size="29" type="timestamp" mandatory="true" position="12">
      <dataModel>_7mb2wpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_date?</dataModel>
    </fieldRef>
    <constraintRef id="_UDeMZJfnEeyJYM9CAJZuPA" type="pk">
      <dataModel>_7mb2xJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing?</dataModel>
    </constraintRef>
    <constraintRef id="_UDeMZZfnEeyJYM9CAJZuPA" type="fk">
      <dataModel>_7mb2xZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_customer?</dataModel>
    </constraintRef>
    <constraintRef id="_UDeMZpfnEeyJYM9CAJZuPA" type="fk">
      <dataModel>_7mb2xpfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_payment?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="_UDezcJfnEeyJYM9CAJZuPA" countShownFields="8" hierarchical="false">
    <dataModel>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_UDezcZfnEeyJYM9CAJZuPA" precision="4" size="19" type="numeric" mandatory="true" position="9">
      <dataModel>_7-P50pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_qty?</dataModel>
      <usage>_UDgoppfnEeyJYM9CAJZuPA</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDezcpfnEeyJYM9CAJZuPA" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>_7-P50JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDezc5fnEeyJYM9CAJZuPA" precision="0" size="10" type="integer" mandatory="true" position="6">
      <dataModel>_7-P50ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bil_id?</dataModel>
      <usage>_UDYFyJfnEeyJYM9CAJZuPA</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDezdJfnEeyJYM9CAJZuPA" precision="4" size="19" type="numeric" position="15">
      <dataModel>_7-P51JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_amount?</dataModel>
      <usage>_UDgoppfnEeyJYM9CAJZuPA</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDezdZfnEeyJYM9CAJZuPA" precision="4" size="19" type="numeric" mandatory="true" position="18">
      <dataModel>_7-Qg4JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_amount?</dataModel>
      <usage>_UDgoppfnEeyJYM9CAJZuPA</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDezdpfnEeyJYM9CAJZuPA" precision="0" size="10" type="integer" position="24">
      <dataModel>_7-Qg4pfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=bdr_id?</dataModel>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDezd5fnEeyJYM9CAJZuPA" precision="4" size="19" type="numeric" position="12">
      <dataModel>_7-P505fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_discount_rate?</dataModel>
      <usage>_UDgoppfnEeyJYM9CAJZuPA</usage>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDezeJfnEeyJYM9CAJZuPA" precision="0" size="3" type="varchar" mandatory="true" position="21">
      <dataModel>_7-Qg4ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=lin_type?</dataModel>
    </fieldRef>
    <constraintRef id="_UDezeZfnEeyJYM9CAJZuPA" type="fk">
      <dataModel>_7-Qg45fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_bedroom?</dataModel>
    </constraintRef>
    <constraintRef id="_UDezepfnEeyJYM9CAJZuPA" type="fk">
      <dataModel>_7-Qg5JfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_billing_lines_billing?</dataModel>
    </constraintRef>
    <constraintRef id="_UDeze5fnEeyJYM9CAJZuPA" type="pk">
      <dataModel>_7-Qg5ZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_t_billing_lines?</dataModel>
    </constraintRef>
  </containerRef>
  <containerRef xsi:type="ref:RDatastore" id="_UDfagJfnEeyJYM9CAJZuPA" countShownFields="7" hierarchical="false">
    <dataModel>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <fieldRef xsi:type="ref:RField" id="_UDfagZfnEeyJYM9CAJZuPA" precision="0" size="32" type="varchar" position="6">
      <dataModel>__a3KoZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_title?</dataModel>
      <expressionRef id="_UDgoopfnEeyJYM9CAJZuPA">
        <dataModel>_AETJMJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDfagpfnEeyJYM9CAJZuPA" precision="0" size="100" type="varchar" mandatory="true" position="9">
      <dataModel>__a3KopfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_name?</dataModel>
      <expressionRef id="_UDgoo5fnEeyJYM9CAJZuPA">
        <dataModel>_AETJMZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDfag5fnEeyJYM9CAJZuPA" precision="0" size="10" type="numeric" position="15">
      <dataModel>__a3KpJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=geo_key_id?</dataModel>
      <expressionRef id="_UDgop5fnEeyJYM9CAJZuPA">
        <dataModel>_AETJNJfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDfahJfnEeyJYM9CAJZuPA" precision="0" size="100" type="varchar" position="12">
      <dataModel>__a3Ko5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_company?</dataModel>
      <expressionRef id="_UDgoqJfnEeyJYM9CAJZuPA">
        <dataModel>_AETJNZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDfahZfnEeyJYM9CAJZuPA" precision="0" size="10" type="integer" mandatory="true" position="3">
      <dataModel>__a3KoJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_id?</dataModel>
      <expressionRef id="_UDgooZfnEeyJYM9CAJZuPA" internalExpression="${t_billing.cus_id}$">
        <dataModel>_AESiIZfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_UDeMYZfnEeyJYM9CAJZuPA</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDgBkJfnEeyJYM9CAJZuPA" precision="0" size="1" type="numeric" position="18">
      <dataModel>__a3KpZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=cus_vip?</dataModel>
      <expressionRef id="_UDgoppfnEeyJYM9CAJZuPA" internalExpression="CASE WHEN SUM( ${t_billing_lines.lin_qty}$&#xA;              *(( ${t_billing_lines.lin_amount}$&#xA;                 -${t_billing_lines.lin_discount_amount}$ ) &#xA;&#x9;&#x9;&#x9;   -( ${t_billing_lines.lin_amount}$&#xA;&#x9;&#x9;&#x9;     *${t_billing_lines.lin_discount_rate}$ /100)))>64000 THEN 1&#xA;     ELSE 0&#xA;END">
        <dataModel>_AETJM5fcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_UDezcZfnEeyJYM9CAJZuPA</sourceRef>
        <sourceRef>_UDezdZfnEeyJYM9CAJZuPA</sourceRef>
        <sourceRef>_UDezdJfnEeyJYM9CAJZuPA</sourceRef>
        <sourceRef>_UDezd5fnEeyJYM9CAJZuPA</sourceRef>
      </expressionRef>
    </fieldRef>
    <fieldRef xsi:type="ref:RField" id="_UDgBkZfnEeyJYM9CAJZuPA" precision="6" size="29" type="timestamp" position="21">
      <dataModel>__a3xsJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=update_date?</dataModel>
      <expressionRef id="_UDgopJfnEeyJYM9CAJZuPA" internalExpression="d::currentTimestamp()">
        <dataModel>_AETJMpfcEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
        <sourceRef>_UDgopZfnEeyJYM9CAJZuPA</sourceRef>
      </expressionRef>
    </fieldRef>
    <constraintRef id="_UDgBkpfnEeyJYM9CAJZuPA" type="fk">
      <dataModel>__a3xsZfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=fk_dim_customer_geo?</dataModel>
    </constraintRef>
    <constraintRef id="_UDgBk5fnEeyJYM9CAJZuPA" type="pk">
      <dataModel>__a3xspfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=pk_dim_customer?</dataModel>
    </constraintRef>
    <constraintRef id="_UDgBlJfnEeyJYM9CAJZuPA" type="ck">
      <dataModel>__a3xs5fbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_001?</dataModel>
    </constraintRef>
    <constraintRef id="_UDgBlZfnEeyJYM9CAJZuPA" type="ck">
      <dataModel>__a3xtJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=ck_cus_geo_key_id_002?</dataModel>
    </constraintRef>
  </containerRef>
  <clauseRef id="_UDYFyJfnEeyJYM9CAJZuPA" internalExpression="${t_billing.bil_id}$ = ${t_billing_lines.bil_id}$">
    <dataModel>_9YwwAJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <sourceRef>_UDc-QJfnEeyJYM9CAJZuPA</sourceRef>
    <sourceRef>_UDezc5fnEeyJYM9CAJZuPA</sourceRef>
  </clauseRef>
  <targetSetRef id="_UDhPvJfnEeyJYM9CAJZuPA" sourceSet="_UDhPu5fnEeyJYM9CAJZuPA">
    <container>_UDfagJfnEeyJYM9CAJZuPA</container>
  </targetSetRef>
  <sourceSetRef id="_UDhPu5fnEeyJYM9CAJZuPA" targetSet="_UDhPvJfnEeyJYM9CAJZuPA">
    <dataSet xsi:type="map:DataSet">#_7d3esJfdEeyNk-8PTn1xFw</dataSet>
  </sourceSetRef>
  <templateRef id="_UDgorZfnEeyJYM9CAJZuPA" description="Load : t_billing, t_billing_lines" nodeCode="com.stambia.flow.step" templateCriteria="type=L-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcProduct=POSTGRESSQL;srcPath=server:hotel/schema:hotel.hotel_management/datastore:t_billing;srcWorkspaceCapability=true;srcMapCapability=true;srcFilterCapability=true;srcJoinCapability=true">
    <dataModel>_7d7JEJfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=L1_dim_customer?</dataModel>
    <problem id="_UDmvQZfnEeyJYM9CAJZuPA" code="WARNING_TEMPLATE_USING_UNPROVIDED_PROCESS" message=""/>
    <load>_UDgoqpfnEeyJYM9CAJZuPA</load>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <templateRef id="_UDhPtZfnEeyJYM9CAJZuPA" description="Integration : dim_customer" nodeCode="com.stambia.flow.step" templateCriteria="type=I-TP;trgProduct=POSTGRESSQL;trgPath=server:datamart/schema:datamart.hotel_datamart/datastore:dim_customer;trgWorkspaceCapability=true;trgMapCapability=true;trgFilterCapability=true;trgJoinCapability=true;srcProductList=POSTGRESSQL">
    <dataModel>_7d9lUJfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map$name=I_dim_customer?</dataModel>
    <problem id="_UDmvQJfnEeyJYM9CAJZuPA" code="WARNING_TEMPLATE_USING_UNPROVIDED_PROCESS" message=""/>
    <targetRef>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</targetRef>
  </templateRef>
  <loadSet id="_UDgoqpfnEeyJYM9CAJZuPA">
    <container>_7mZagJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
    <container>_7-PSwJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <loadSet id="_UDgorJfnEeyJYM9CAJZuPA">
    <container>__a2jkJfbEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</container>
  </loadSet>
  <udfRef id="_UDgopZfnEeyJYM9CAJZuPA">
    <dataModel>_epkM4JfdEeyNk-8PTn1xFw?fileId=_CgoeMJfbEeyNk-8PTn1xFw$type=map?</dataModel>
    <usage>_UDgopJfnEeyJYM9CAJZuPA</usage>
  </udfRef>
</ref:mapRef>