*** Step 3 ***
**************

EXPRESSION of the Q_GEN_DAYS query
------------------------------------------------
	SELECT gen_day
	FROM   UNNEST(SEQUENCE_ARRAY(0, 30, 1)) AS generate_series(gen_day)


*** Step 5 ***
**************

Expression editor of the field ACTIVITY_DATE
----------------------------------------------------------------------
        TIMESTAMP(ACTIVITY.ACT_YEAR+'-'+LPAD(CAST(ACTIVITY.ACT_MONTH AS VARCHAR),2,'0')+'-01') + Q_GEN_DAYS.GEN_DAY DAY 

Expression editor of the field ACTIVITY_CODE
-----------------------------------------------------------------------------------------
CASE WHEN Q_GEN_DAYS.GEN_DAY=0 AND ACTIVITY.CODE_ID01 IS NOT NULL THEN ACTIVITY.CODE_ID01
     WHEN Q_GEN_DAYS.GEN_DAY=1 AND ACTIVITY.CODE_ID02 IS NOT NULL THEN ACTIVITY.CODE_ID02
     WHEN Q_GEN_DAYS.GEN_DAY=2 AND ACTIVITY.CODE_ID03 IS NOT NULL THEN ACTIVITY.CODE_ID03
     WHEN Q_GEN_DAYS.GEN_DAY=3 AND ACTIVITY.CODE_ID04 IS NOT NULL THEN ACTIVITY.CODE_ID04
     WHEN Q_GEN_DAYS.GEN_DAY=4 AND ACTIVITY.CODE_ID05 IS NOT NULL THEN ACTIVITY.CODE_ID05
     WHEN Q_GEN_DAYS.GEN_DAY=5 AND ACTIVITY.CODE_ID06 IS NOT NULL THEN ACTIVITY.CODE_ID06
     WHEN Q_GEN_DAYS.GEN_DAY=6 AND ACTIVITY.CODE_ID07 IS NOT NULL THEN ACTIVITY.CODE_ID07
     WHEN Q_GEN_DAYS.GEN_DAY=7 AND ACTIVITY.CODE_ID08 IS NOT NULL THEN ACTIVITY.CODE_ID08
     WHEN Q_GEN_DAYS.GEN_DAY=8 AND ACTIVITY.CODE_ID09 IS NOT NULL THEN ACTIVITY.CODE_ID09
     WHEN Q_GEN_DAYS.GEN_DAY=9 AND ACTIVITY.CODE_ID10 IS NOT NULL THEN ACTIVITY.CODE_ID10
     WHEN Q_GEN_DAYS.GEN_DAY=10 AND ACTIVITY.CODE_ID11 IS NOT NULL THEN ACTIVITY.CODE_ID11
     WHEN Q_GEN_DAYS.GEN_DAY=11 AND ACTIVITY.CODE_ID12 IS NOT NULL THEN ACTIVITY.CODE_ID12
     WHEN Q_GEN_DAYS.GEN_DAY=12 AND ACTIVITY.CODE_ID13 IS NOT NULL THEN ACTIVITY.CODE_ID13
     WHEN Q_GEN_DAYS.GEN_DAY=13 AND ACTIVITY.CODE_ID14 IS NOT NULL THEN ACTIVITY.CODE_ID14
     WHEN Q_GEN_DAYS.GEN_DAY=14 AND ACTIVITY.CODE_ID15 IS NOT NULL THEN ACTIVITY.CODE_ID15
     WHEN Q_GEN_DAYS.GEN_DAY=15 AND ACTIVITY.CODE_ID16 IS NOT NULL THEN ACTIVITY.CODE_ID16
     WHEN Q_GEN_DAYS.GEN_DAY=16 AND ACTIVITY.CODE_ID17 IS NOT NULL THEN ACTIVITY.CODE_ID17
     WHEN Q_GEN_DAYS.GEN_DAY=17 AND ACTIVITY.CODE_ID18 IS NOT NULL THEN ACTIVITY.CODE_ID18
     WHEN Q_GEN_DAYS.GEN_DAY=18 AND ACTIVITY.CODE_ID19 IS NOT NULL THEN ACTIVITY.CODE_ID19
     WHEN Q_GEN_DAYS.GEN_DAY=19 AND ACTIVITY.CODE_ID20 IS NOT NULL THEN ACTIVITY.CODE_ID20
     WHEN Q_GEN_DAYS.GEN_DAY=20 AND ACTIVITY.CODE_ID21 IS NOT NULL THEN ACTIVITY.CODE_ID21
     WHEN Q_GEN_DAYS.GEN_DAY=21 AND ACTIVITY.CODE_ID22 IS NOT NULL THEN ACTIVITY.CODE_ID22
     WHEN Q_GEN_DAYS.GEN_DAY=22 AND ACTIVITY.CODE_ID23 IS NOT NULL THEN ACTIVITY.CODE_ID23
     WHEN Q_GEN_DAYS.GEN_DAY=23 AND ACTIVITY.CODE_ID24 IS NOT NULL THEN ACTIVITY.CODE_ID24
     WHEN Q_GEN_DAYS.GEN_DAY=24 AND ACTIVITY.CODE_ID25 IS NOT NULL THEN ACTIVITY.CODE_ID25
     WHEN Q_GEN_DAYS.GEN_DAY=25 AND ACTIVITY.CODE_ID26 IS NOT NULL THEN ACTIVITY.CODE_ID26
     WHEN Q_GEN_DAYS.GEN_DAY=26 AND ACTIVITY.CODE_ID27 IS NOT NULL THEN ACTIVITY.CODE_ID27
     WHEN Q_GEN_DAYS.GEN_DAY=27 AND ACTIVITY.CODE_ID28 IS NOT NULL THEN ACTIVITY.CODE_ID28
     WHEN Q_GEN_DAYS.GEN_DAY=28 AND ACTIVITY.CODE_ID29 IS NOT NULL THEN ACTIVITY.CODE_ID29
     WHEN Q_GEN_DAYS.GEN_DAY=29 AND ACTIVITY.CODE_ID30 IS NOT NULL THEN ACTIVITY.CODE_ID30
     WHEN Q_GEN_DAYS.GEN_DAY=30 AND ACTIVITY.CODE_ID31 IS NOT NULL THEN ACTIVITY.CODE_ID31
     ELSE NULL END
	 
Expression editor of the filter
-------------------------------
stage.ACTIVITY_CODE IS NOT NULL