DROP SCHEMA BI_WEATHER IF EXISTS CASCADE;
CREATE SCHEMA BI_WEATHER;
CREATE TABLE BI_WEATHER.PARAM_DEPT (
ID_DEPT INT NOT NULL,NM_DEPT VARCHAR(50),
THUNDERSTORM_MIN INT,THUNDERSTORM_MAX INT,RAINY_MIN INT,RAINY_MAX INT,
CLOUDY_MIN INT,CLOUDY_MAX INT,THINNING_MIN INT,THINNING_MAX INT,SUNNY_MIN INT,SUNNY_MAX INT,
CONSTRAINT PK_PARAM_DEPT PRIMARY KEY (ID_DEPT));

INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (1,'Compliance',0,5,6,15,16,40,41,65,66,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (2,'Finance',0,8,9,18,19,27,28,55,56,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (3,'Human_ressource',0,4,5,12,13,30,31,60,61,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (4,'Industry',0,9,10,25,26,42,43,61,62,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (5,'Information_technology',0,7,8,22,23,36,37,55,56,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (6,'Legal',0,11,12,25,26,44,45,62,63,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (7,'Marketing',0,15,16,25,26,46,47,70,71,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (8,'Purchase',0,9,10,21,22,34,35,55,56,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (9,'Sales',0,5,6,15,16,40,41,65,66,100);
INSERT INTO BI_WEATHER.PARAM_DEPT VALUES (10,'Strategy',0,8,9,18,19,27,28,55,56,100);

CREATE TABLE BI_WEATHER.DAILY_DEPT_ACTIVITY (
DT_ACTIVITY DATE NOT NULL,ID_DEPT INT NOT NULL,ACHIEV_PERCENT INT,
CONSTRAINT PK_DAILY_DEPT_ACTIVITY PRIMARY KEY (DT_ACTIVITY,ID_DEPT));
INSERT INTO BI_WEATHER.DAILY_DEPT_ACTIVITY 
SELECT CURRENT_DATE AS DT_ACTIVITY,ID_DEPT,CAST(RAND()*100 AS INTEGER) ACHIEV_PERCENT
FROM   BI_WEATHER.PARAM_DEPT;