<?xml version="1.0" encoding="UTF-8"?>
<proc:process xmlns:proc="http://www.example.org/proc" id="_Uw-4wqaCEeqBEY-hacvGKA" description="This template is used to load data from a Salesforce Object to Oracle using SQL*Loader.&#xD;&#xA;&#xD;&#xA;Salesforce data is first exported into a file and then loaded into the target Oracle table.&#xD;&#xA;&#xD;&#xA;The Runtime must be located on a place where SQL loader utility is available.&#xD;&#xA;&#xD;&#xA;Refer to the description of each Parameter for more information.&#xD;&#xA;&#xD;&#xA;Please note that this template requires &quot;Load Xml to Oracle&quot; template in the workspace in order to work.&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;History:&#xD;&#xA;27/10/2020&#x9;Template creation&#xD;&#xA;" name="Load Salesforce to Oracle.tp">
  <parameter id="_Uw-4w6aCEeqBEY-hacvGKA" description="Set this option to true to use the Salesforce Bulk API.&#xD;&#xA;&#xD;&#xA;Depending on the context, this can offer better performances and the possibility to use less batches to receive data.&#xD;&#xA;This is particularly useful when retrieving a lot of data from Salesforce.&#xD;&#xA;&#xD;&#xA;However, on small amount of data, using the Bulk API is not useful and might be slower that standard API" label="Bulk Mode" name="SForceBulk" type="Boolean" value="false"/>
  <parameter id="_Uw-4xKaCEeqBEY-hacvGKA" description="If true, the temporary objects created during the load are removed at the end of the process." name="cleanTemporaryObjects" type="Boolean" value="true"/>
  <parameter id="_Uw-4xaaCEeqBEY-hacvGKA" description="Specifies if Salesforce data should be exported.&#xD;&#xA;&#xD;&#xA;- If set to true, Salesforce data will be exported and loaded into the load table.&#xD;&#xA;- If set to false, you can optionally use the 'In File Name' parameter to define a custom (already extracted) file to load.&#xD;&#xA;The template will then use it to load the load table.&#xD;&#xA;&#xD;&#xA;Note that this is option MUST be set to false if you are using this template to retrieve the result of the previous Step.&#xD;&#xA;For instance, if you performed an Insert operation on a Salesforce Object, and you want to retrieve the status of the insert, the ids of the inserted objects, ..., set it to false.&#xD;&#xA;&#xD;&#xA;Otherwise, the template will not re-use the result of the previous step and perform a new export of Salesforce data." name="enableExport" type="Boolean" value="true"/>
  <parameter id="_Uw-4xqaCEeqBEY-hacvGKA" description="To be used with mode bulk when during export of the data you encounter an error Invalid Character. &#xD;&#xA;Normally this means in your source data there is an invalid charcter (like 0x1a). &#xD;&#xA;If you can it is advised to correct this in the source data by removing the incorrect charcter directly in Salesforce.&#xD;&#xA;If this is not possible you can activate this option which will remove those characters from the temporary xml file." name="cleanInvalidCharacters" type="Boolean" value="false"/>
  <parameter id="_Uw-4x6aCEeqBEY-hacvGKA" description="If this option is set to true, the template will load the extracted Salesforce data into the Load table with a distinct behavior.&#xD;&#xA;This is used to avoid having duplicates in the load table." name="useDistinct" type="Boolean" value="false"/>
  <parameter id="_Uw-4yKaCEeqBEY-hacvGKA" description="Defines if the empty elements should be treated as null values" name="emptyElementAsNull" type="Boolean" value="false"/>
  <parameter id="_Uw-4yaaCEeqBEY-hacvGKA" description="Defines the behavior to follow when no extract file is found.&#xD;&#xA;This can happen when the file specified with 'In File Name' parameter doesn't exist for instance.&#xD;&#xA;If this is set to true, the process will succeed when facing this case.&#xD;&#xA;If set to false, an error will be thrown." name="successIfNoFile" type="Boolean" value="false"/>
  <parameter id="_Uw-4yqaCEeqBEY-hacvGKA" name="extractBase64BinaryToFile" type="Boolean" value="false"/>
  <parameter id="_Uw-4y6aCEeqBEY-hacvGKA" description="Optional path to the extracted Salesforce file to load.&#xD;&#xA;This can be used to specify a custom file when the 'Enable Export' parameter is set to false." name="inFileName" type="String"/>
  <parameter id="_Uw-4zKaCEeqBEY-hacvGKA" description="Allows to specify a custom additional filter to add to the Salesforce query extracting data." name="additionalFilter" type="String" value=""/>
  <parameter id="_Uw-4zaaCEeqBEY-hacvGKA" name="errorDir" type="String" value=""/>
  <parameter id="_Uw-4z6aCEeqBEY-hacvGKA" name="superRootName" type="String" value=""/>
  <parameter id="_Uw-40KaCEeqBEY-hacvGKA" name="base64BinariesExtractDirectory" type="String" value=""/>
  <parameter id="_Uw-40aaCEeqBEY-hacvGKA" description="Specifies the concurrency mode used by Salesforce when retrieving data with the Bulk Mode.&#xD;&#xA;&#xD;&#xA;- Serial:  Retrieved data is processed by Salesforce in serial batches&#xD;&#xA;- Parallel: Retrieved data is processed by Salesforce in parallel batches.&#xD;&#xA;&#xD;&#xA;This changes how Salesforce processes data behind the scenes and not how the Runtime retrieves the batches of data.&#xD;&#xA;Semarchy retrieves the batches of data the same way in both modes.&#xD;&#xA;Using one or the other mode can however provide better performances depending on the amount of data processed." metaInf="&lt;metaInf id=&quot;value&quot;  value=&quot;Serial&quot;/>&#xD;&#xA;&lt;metaInf id=&quot;value&quot;  value=&quot;Parallel&quot;/>" name="SForceBulkConcurrencyMode" type="String" value="Serial"/>
  <parameter id="_Uw-40qaCEeqBEY-hacvGKA" description="Amount of time to wait between each job status check in Bulk Mode.&#xD;&#xA;&#xD;&#xA;When reading data using Bulk Mode the Runtime will periodically check the state of the Salesforce Job to find if it is completed.&#xD;&#xA;This parameter defines the amount of time to wait between each check." name="SForceBulkAwaitPollint" type="Integer" value="10000"/>
  <parameter id="_Uw-406aCEeqBEY-hacvGKA" description="Timeout for the data loading in Bulk Mode.&#xD;&#xA;&#xD;&#xA;When reading data using Bulk Mode the Runtime will periodically check the state of the Salesforce Job to find if it is completed.&#xD;&#xA;When this check is performed, the Runtime will also check if the amount of time elapsed since the job is being processed.&#xD;&#xA;If it reached the timeout defined in this parameter an error will be thrown.&#xD;&#xA;&#xD;&#xA;Note that -1 can be specified to define an infinite timeout.&#xD;&#xA;&#xD;&#xA;See also the 'SForce Bulk Await Pollint' parameter which is used to specify the time to wait between each check." name="SForceBulkAwaitTimeout" type="Integer" value="-1"/>
  <parameter id="_Uw-41KaCEeqBEY-hacvGKA" description="Size of a chunk when using Bulk Mode for exporting data.&#xD;&#xA;&#xD;&#xA;- When using 0 (default value) chunking is disabled and data is exported in a single batch. &#xD;&#xA;- When using a value greater than 0 Salesforce automatically calculates a number of batches based on the value specified by analyzing data to be extracted and splitting it into multiples batches.&#xD;&#xA;- Maximum value allowed by Salesforce is 250000. &#xD;&#xA;&#xD;&#xA;This might be useful when you are retrieving a large set of data to avoid experiencing timeouts errors from Salesforce.&#xD;&#xA;Make sure the value is not too small as this increases the number of batches performed, which can be day limited by Salesforce.&#xD;&#xA;&#xD;&#xA;Refer to Salesforce PK Chunking Header reference documentation for further information." label="" name="SForceBulkChunkSize" type="Integer" value="0"/>
  <parameter id="_Uw-41qaCEeqBEY-hacvGKA" description="Directory in which the temporary files generated during the load are stored.&#xD;&#xA;Note that the Runtime must have access to it." name="workFolder" type="String" value="${/CORE_JAVA_TEMPORARY_FOLDER}$"/>
  <parameter id="_xmS3MaaCEeqBEY-hacvGKA" description="Maximum number of discarded records allowed." name="discardmax" type="String" value="1"/>
  <parameter id="_xmS3MqaCEeqBEY-hacvGKA" description="Maximum number of errors allowed." name="errorsOption" type="String" value="0"/>
  <parameter id="_xmS3M6aCEeqBEY-hacvGKA" description="Source XML files encoding.&#xD;&#xA;&#xD;&#xA;This corresponds to the encoding of source xml files and will be used when reading them while exporting to temporary files.&#xD;&#xA;&#xD;&#xA;Note that exported temporary files will not use this encoding which is only used for reading source xml files.&#xD;&#xA;Temporary files are created by the Template in UTF-8 and loaded into Oracle using UTF-8." name="inFileEncoding" type="String" value=""/>
  <parameter id="_xmS3NKaCEeqBEY-hacvGKA" description="ASCII field separator used to separate the fields in exported temporary files." name="fieldSeparator" type="String" value="~"/>
  <parameter id="_xmS3NaaCEeqBEY-hacvGKA" description="Used to specify options on the load table. They are added at the end of the create table statement." name="loadTableOptions" type="String" value=""/>
  <parameter id="_xmS3NqaCEeqBEY-hacvGKA" description="Character to use to separate the records in the temporary files." name="recordSeparator" type="String" value="\n"/>
  <parameter id="__lsKQKaCEeqBEY-hacvGKA" name="sqlBatchSize" type="String" value="1000"/>
  <parameter id="_2RjRIKadEeqBEY-hacvGKA" description="This parameter defines:&#xD;&#xA;&#xD;&#xA;- The JDBC Fetch size (number of lines) used when querying the source database.&#xD;&#xA;Larger values provide better performance but consume more memory in the Runtime as the data is stored in the Memory before being sent to the Load table.&#xD;&#xA;&#xD;&#xA;- The value of the ROWS option used in the CTL file (in SQL Loader Mode).&#xD;&#xA;This option specifies the number of rows to treat for each batch.&#xD;&#xA;" name="fetchSize" type="String" value="30000"/>
  <parameter id="_79WWUKadEeqBEY-hacvGKA" description="Defines if the Oracle 'DIRECT' option should be used when loading source data with SQL*Loader.&#xD;&#xA;&#xD;&#xA;This provides better performance but requires that the file containing source data is located on the same server as the Database.&#xD;&#xA;&#xD;&#xA;If true, the direct option is used, allowing SQL Loader to perform a direct path load.&#xD;&#xA;If false, the direct option is not used. SQL Loader will then perform a conventional path load.&#xD;&#xA;&#xD;&#xA;Please refer to the Oracle documentation for more information." name="useDirectOption" type="Boolean" value="true"/>
  <parameter id="_Fpz0kKaeEeqBEY-hacvGKA" description="Defines if the Oracle parallel option must used when loading source data.&#xD;&#xA;&#xD;&#xA;If true, the parallel option is used.&#xD;&#xA;If false, the parallel option is not used.&#xD;&#xA;&#xD;&#xA;Please refer to the Oracle documentation for more information." metaInf="" name="useParallelOption" type="Boolean" value="false"/>
  <subProcess id="_Uw-42KaCEeqBEY-hacvGKA" isBeginAction="false" name="Load" nbCycles="-1" toleratedError="false">
    <link id="_Uw-42aaCEeqBEY-hacvGKA" executionType="OK" generationType="OK" mandatory="1" targetId="_Uw-486aCEeqBEY-hacvGKA?fileId=_Uw-4wqaCEeqBEY-hacvGKA$type=proc$name=Clean?"/>
    <actionCode id="_Uw-42qaCEeqBEY-hacvGKA" generationCondition="'${enableExport}$'='true'" enable="true" isBeginAction="false" name="SalesForceExport" nbCycles="-1" toleratedError="false" technology="com.indy.engine.addons.salesforce.SForceToXmlActionCodeI">
      <link id="_G9_NgKaDEeqBEY-hacvGKA" executionType="OK" generationType="OK_KO" mandatory="1" targetId="_FYRM4KaDEeqBEY-hacvGKA"/>
      <parameter id="_Uw-43KaCEeqBEY-hacvGKA" name="SFORCE_LOGIN" type="String" value="%x{$SOURCE/ref:server()/tech:login()}x%"/>
      <parameter id="_Uw-43aaCEeqBEY-hacvGKA" name="SFORCE_PASSWORD" type="String" value="%x{$SOURCE/ref:server()/tech:password()}x%"/>
      <parameter id="_Uw-43qaCEeqBEY-hacvGKA" name="SFORCE_SECURITY_TOKEN" type="String" value="%x{$SOURCE/ref:server()/tech:securityToken()}x%"/>
      <parameter id="_Uw-436aCEeqBEY-hacvGKA" name="SFORCE_AUTH_END_POINT" type="String" value="%x{$SOURCE/ref:server()/tech:authEndPoint()}x%"/>
      <parameter id="_Uw-44KaCEeqBEY-hacvGKA" name="OUT_FILE_NAME" type="String" value="%x{concat('${/CORE_TEMPORARY_FOLDER}$/',$SOURCE/@id,'.xml')}x%"/>
      <parameter id="_Uw-44aaCEeqBEY-hacvGKA" name="PROXY_HOST" type="String" value="%x{$SOURCE/ref:server()/@proxyHost}x%"/>
      <parameter id="_Uw-44qaCEeqBEY-hacvGKA" name="PROXY_PORT" type="String" value="%x{$SOURCE/ref:server()/@proxyPort}x%"/>
      <parameter id="_Uw-446aCEeqBEY-hacvGKA" name="PROXY_USER" type="String" value="%x{$SOURCE/ref:server()/@proxyUser}x%"/>
      <parameter id="_Uw-45KaCEeqBEY-hacvGKA" name="PROXY_PASSWORD" type="String" value="%x{$SOURCE/ref:server()/@proxyPassword}x%"/>
      <parameter id="_Uw-45aaCEeqBEY-hacvGKA" name="SFORCE_AUTH_PROPERTIES" type="String" value="%x{$SOURCE/ref:authentication()/tech:toJavaProperties()}x%"/>
      <parameter id="_Uw-45qaCEeqBEY-hacvGKA" name="SF_READ_TIMEOUT" type="Integer" value="%x{$SOURCE/ref:server()/tech:readTimeout()}x%"/>
      <parameter id="_Uw-456aCEeqBEY-hacvGKA" name="SF_CONNECTION_TIMEOUT" type="Integer" value="%x{$SOURCE/ref:server()/tech:connectionTimeout()}x%"/>
      <parameter id="_Uw-46KaCEeqBEY-hacvGKA" name="SF_BULK_ENABLE" type="String" value="%x{md:paramValue($this/..,'SForceBulk')}x%"/>
      <parameter id="_Uw-46aaCEeqBEY-hacvGKA" name="SF_CLEAN_INVALID_CHAR" type="String" value="%x{md:paramValue($this/..,'cleanInvalidCharacters')}x%"/>
      <parameter id="_Uw-46qaCEeqBEY-hacvGKA" name="SF_BULK_CONCURRENCY_MODE" type="String" value="%x{md:paramValue($this/..,'SForceBulkConcurrencyMode')}x%"/>
      <parameter id="_Uw-466aCEeqBEY-hacvGKA" name="SF_READ_BULK_WAIT_POLL_INT" type="String" value="%x{md:paramValue($this/..,'SForceBulkAwaitPollint')}x%"/>
      <parameter id="_Uw-47KaCEeqBEY-hacvGKA" name="SF_READ_BULK_WAIT_TIMEOUT" type="String" value="%x{md:paramValue($this/..,'SForceBulkAwaitTimeout')}x%"/>
      <parameter id="_Uw-47aaCEeqBEY-hacvGKA" name="SF_READ_BULK_CHUNK_SIZE" type="Integer" value="%x{md:ifEmpty(md:paramValue($this/..,'SForceBulkChunkSize'),0)}x%"/>
      <parameter id="_Uw-47qaCEeqBEY-hacvGKA" name="SF_DISABLE_LOGOUT" type="Boolean" value="%x{md:ifEmpty($disableSessionLogout,'false')}x%"/>
      <code>&lt;descriptor>&#xD;
%xsl{&#xD;
&lt;xsl:variable name=&quot;mappedField&quot; select=&quot;$REF/ref:fields()/ref:sources()/@id&quot;/>&#xD;
&lt;xsl:for-each select=&quot;$SOURCE&quot;>&#xD;
&amp;lt;query sObjectName=&quot;%x{@name}x%&quot;>select %x{md:patternList(./ref:columns()[$mappedField=@id],'[name]',',')}x% from %x{@name}x%&#xD;
%x{md:patternList($filterClause/filter,'{@expression}',' AND ',' WHERE ')}x%&#xD;
&amp;lt;/query>&#xD;
&lt;/xsl:for-each>&#xD;
}xsl%&#xD;
&lt;/descriptor></code>
    </actionCode>
    <actionProcessRef id="_FYRM4KaDEeqBEY-hacvGKA" isBeginAction="false" name="Load to Oracle" nbCycles="-1" toleratedError="false" targetName="LOAD%20XML%20to%20Oracle%20(with%20SQL%20Loader).proc#_7Enc4ZiHEeeNWuw44hbC5g?fileId=_7EncwpiHEeeNWuw44hbC5g$type=proc$name=Load?"/>
    <templateType>L-TP.RDBMS.LOADING</templateType>
    <xslVariable id="_Uw-48KaCEeqBEY-hacvGKA" code="$REF/ref:source()" name="SOURCE" type="xpath"/>
    <xslVariable id="_Uw-48aaCEeqBEY-hacvGKA" code="%xsl{&#xD;&#xA;&lt;xsl:for-each select=&quot;$REF/ref:filter()&quot;>&#xD;&#xA;&lt;filter expression=&quot;{tech:expression()}&quot;/>&#xD;&#xA;&lt;/xsl:for-each>&#xD;&#xA;&lt;xsl:if test=&quot;md:paramValue($this,'additionalFilter')!=''&quot;>&#xD;&#xA;&lt;filter expression=&quot;{md:paramValue($this,'additionalFilter')}&quot;/>&#xD;&#xA;&lt;/xsl:if>&#xD;&#xA;&#xD;&#xA;}xsl%" name="filterClause" type="xsl"/>
    <xslVariable id="_Uw-48qaCEeqBEY-hacvGKA" code="if(md:paramValue($this,'disableSessionLogout') !='')&#xD;&#xA;&#x9;then &#xD;&#xA;&#x9;&#x9;md:paramValue($this,'disableSessionLogout')&#xD;&#xA;&#x9;else&#xD;&#xA;&#x9;&#x9;if($SOURCE/ref:server()/tech:disableSessionLogout()!='')&#xD;&#xA;&#x9;&#x9;&#x9;then&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;$SOURCE/ref:server()/tech:disableSessionLogout()&#xD;&#xA;&#x9;&#x9;&#x9;else&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;'false'&#xD;&#xA;&#x9;&#x9;&#x9;&#x9;" name="disableSessionLogout" order="1" type="xpath"/>
  </subProcess>
  <subProcess id="_Uw-486aCEeqBEY-hacvGKA" description="" generationCondition="'${cleanTemporaryObjects}$'='true'" isBeginAction="false" name="Clean" nbCycles="-1" toleratedError="false">
    <actionProcessRef id="_IF7QgKaEEeqBEY-hacvGKA" isBeginAction="false" name="Clean" nbCycles="-1" toleratedError="false" targetName="LOAD%20XML%20to%20Oracle%20(with%20SQL%20Loader).proc#_7Enc_JiHEeeNWuw44hbC5g?fileId=_7EncwpiHEeeNWuw44hbC5g$type=proc$name=Clean?"/>
    <templateType>L-TP.RDBMS.CLEANING</templateType>
  </subProcess>
  <templateType>L-TP.RDBMS</templateType>
</proc:process>